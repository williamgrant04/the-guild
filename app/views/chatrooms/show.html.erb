<div class="main-container">
  <div class="upper-container">
    <div class="tabs">
      <%= link_to @guild || @source.is_a?(Guild) ? guild_path(@guild) : game_path(@chatroom.game), class: "tab" do %>
        <p>Members</p>
      <% end %>
      <%= link_to chatroom_path(@chatroom), class: "tab" do %>
        <p>Chat</p>
      <% end %>
      <%= link_to @guild || @source.is_a?(Guild) ? guild_events_path(@guild) : game_events_path(@chatroom.game), class: "tab" do %>
        <p>Events</p>
      <% end %>
    </div>

    <% if @guild.owner == current_user.member %>
      <button data-controller="clipboard" data-action="click->clipboard#copy" data-clipboard-code-value="<%= @guild.join_code %>" class="tab invite">
        <p>Invite a member</p>
      </button>
    <% end %>
  </div>

  <div class="chat-container" data-controller="chat-sub" data-chat-sub-chat-id-value="<%= @chatroom.id %>">
    <div class="messages" data-chat-sub-target="messages">
      <% @messages.each do |message| %>
        <%# This looks stupid but it makes sense, passing the message as the local with the same name %>
        <%= render 'shared/message', message: message %>
      <% end %>
    </div>

    <%# Would put a div here but not needed %>
    <%= simple_form_for [@chatroom, @message], html: { autocomplete: "off", data: { action: "turbo:submit-end->chat-sub#resetForm" }} do |f| %>
      <%=
        f.input :content,
        as: :string,
        label: false,
        placeholder: "Message ##{@chatroom.name}"
      %>
      <%= button_tag type: :submit do %>
        <i class='fa-regular fa-paper-plane' aria-label="Send message"></i>
      <% end %>
    <% end %>
  </div>
</div>
